CyberShield Portal - Week 4: Advanced Threat Detection

This folder contains my work for Week 4 of the Cyber Security Internship. The focus of this week was on implementing API hardening and setting up a monitoring system for real-time threat detection.

Implemented Security Features

1. Intrusion Detection System (Fail2Ban)

Monitoring: I configured Fail2Ban to track the security.log file generated by the server.

Automated Response: I set up a custom jail that watches for 6 failed login attempts within a 60-second window. If triggered, the system uses iptables to ban the source IP address for 10 minutes.

Alerting: I built a Threat Intelligence dashboard on the frontend that displays security events as they are logged on the server.

2. API Hardening

Rate Limiting: I used the express-rate-limit middleware to set up two different security tiers. The general API is limited to 100 requests every 15 minutes, while the login route is restricted to 10 attempts every 10 minutes to prevent brute-force attacks.

CORS: I configured Cross-Origin Resource Sharing to ensure only authorized origins can access the API.

JWT Authentication: I updated the endpoints to use JSON Web Tokens (JWT) for more secure, stateless authentication.

3. Web Security Headers (Helmet.js)

Content Security Policy (CSP): I implemented a CSP to help prevent XSS and other script injection attacks.

HSTS: I enabled Strict-Transport-Security to ensure the browser only communicates over secure connections.

X-Content-Type-Options: I added this to prevent the browser from trying to guess MIME types, which helps avoid sniffing attacks.

How to Run the Project

Install the necessary packages: npm install express sqlite3 winston bcrypt jsonwebtoken validator helmet express-rate-limit cors

Start the application: node app.js

Access the portal at: http://localhost:3000

Verification Steps

Go to the Secure Verification page and enter the wrong credentials 6 times.

Run "sudo fail2ban-client status nodejs-app" in the terminal to verify the IP has been added to the jail.

The frontend should display a fatal error message once the connection is dropped by the firewall.
